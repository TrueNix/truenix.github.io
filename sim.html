<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Page‑in‑a‑Page Demo</title>
  <style>
    :root { --bg:#0f1220; --panel:#14172a; --muted:#a7b0c0; --text:#e8ecf1; --accent:#6aa5ff; --border:#22263e; }
    html,body{height:100%}
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#0f1220,#0b0d18);color:var(--text);font:16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    header{display:flex;align-items:center;gap:16px;flex-wrap:wrap}
    h1{font-size:22px;margin:0}
    .badge{font-size:12px;color:var(--muted);padding:4px 8px;border:1px solid var(--border);border-radius:999px}
    .card{background:var(--panel);border:1px solid var(--border);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    .controls{display:grid;grid-template-columns:1fr auto;gap:12px;padding:16px;border-bottom:1px solid var(--border)}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    .url-input{flex:1;min-width:240px;padding:12px 14px;border-radius:12px;border:1px solid var(--border);background:#0e1122;color:var(--text)}
    .btn{appearance:none;border:1px solid var(--border);background:#0f3a7c;color:#fff;padding:12px 14px;border-radius:12px;cursor:pointer}
    .btn.secondary{background:transparent;color:var(--text)}
    .btn:focus-visible{outline:3px solid var(--accent);outline-offset:2px}
    .quick{display:flex;gap:8px;flex-wrap:wrap}
    .quick .btn{padding:8px 10px;font-size:13px}
    .tabs{display:flex;gap:8px;padding:12px 16px}
    .tab{padding:8px 12px;border-radius:10px;border:1px solid var(--border);background:transparent;color:var(--text);cursor:pointer}
    .tab.active{background:#0e1122}
    .viewer{position:relative;height:70vh}
    iframe{width:100%;height:100%;border:0;border-radius:0 0 16px 16px;background:#0a0c18}
    .note{color:var(--muted);font-size:13px;padding:12px 16px;border-top:1px solid var(--border)}
    .tag{display:inline-block;padding:3px 8px;border:1px solid var(--border);border-radius:999px;margin-right:6px}
    .overlay{position:absolute;inset:0;display:none;align-items:center;justify-content:center;padding:24px;text-align:center;background:linear-gradient(180deg,rgba(15,18,32,.7),rgba(10,12,24,.7));backdrop-filter:blur(3px)}
    .overlay.show{display:flex}
    .small{font-size:12px;color:var(--muted)}
    @media (max-width:640px){ .controls{grid-template-columns:1fr} .viewer{height:65vh} }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Page‑in‑a‑Page Demo</h1>
      <span class="badge">Embed a web page inside this page</span>
    </header>

    <section class="card" aria-label="Embed controls and viewer">
      <form class="controls" id="controlForm">
        <div class="row" style="grid-column:1 / -1">
          <input id="url" class="url-input" type="url" inputmode="url" placeholder="Enter a URL (https://…)" value="https://example.com" aria-label="URL to load" />
          <button class="btn" id="loadBtn" type="submit">Load URL</button>
          <button class="btn secondary" id="clearBtn" type="button" title="Clear and reset">Reset</button>
        </div>
        <div class="row" style="grid-column:1 / -1;align-items:center;justify-content:space-between">
          <div class="quick" aria-label="Quick links">
            <button class="btn secondary" data-quick="https://example.com" type="button">example.com</button>
            <button class="btn secondary" data-quick="https://developer.mozilla.org/" type="button">MDN</button>
            <button class="btn secondary" data-quick="https://en.wikipedia.org/wiki/HTML" type="button">Wikipedia</button>
            <button class="btn secondary" data-quick="https://codesandbox.io/" type="button">CodeSandbox</button>
          </div>
          <div class="small" id="status">Ready</div>
        </div>
      </form>

      <div class="tabs" role="tablist" aria-label="Content source">
        <button class="tab active" role="tab" aria-selected="true" id="tabLive">Live URL</button>
        <button class="tab" role="tab" aria-selected="false" id="tabBuiltIn">Built‑in demo page</button>
      </div>

      <div class="viewer">
        <iframe id="frame" title="Embedded page"
          sandbox="allow-same-origin allow-scripts allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-downloads allow-modals allow-presentation"
          referrerpolicy="no-referrer"
          src="https://example.com"></iframe>
        <div class="overlay" id="overlay">
          <div>
            <h3>Hmm… this site won't allow embedding</h3>
            <p class="small">Many sites send <code>X‑Frame‑Options</code> or a Content Security Policy that blocks being shown inside an iframe. Try a different URL or use the Built‑in demo tab.</p>
          </div>
        </div>
      </div>

      <div class="note">
        <span class="tag">Heads‑up</span>
        Some websites block embedding for security. That's normal. This demo sandboxes the iframe and strips referrers to be safer.
      </div>
    </section>

    <footer class="small" style="margin-top:16px">
      Made for demonstration. No tracking, no external libraries.
    </footer>
  </div>

  <script>
    const $ = (sel) => document.querySelector(sel);
    const urlInput = $('#url');
    const form = $('#controlForm');
    const loadBtn = $('#loadBtn');
    const clearBtn = $('#clearBtn');
    const frame = $('#frame');
    const overlay = $('#overlay');
    const status = $('#status');
    const tabLive = $('#tabLive');
    const tabBuiltIn = $('#tabBuiltIn');

    const builtInPage = `<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content=width=device-width,initial-scale=1><title>Mini App</title>
      <style>body{font:16px system-ui;margin:0;background:#0b1020;color:#e8ecf1;}
      .wrap{max-width:720px;margin:0 auto;padding:24px}
      .card{background:#14172a;border:1px solid #22263e;border-radius:16px;padding:16px}
      button{border:1px solid #22263e;border-radius:12px;background:#0f3a7c;color:#fff;padding:10px 12px;cursor:pointer}
      input{background:#0e1122;color:#e8ecf1;border:1px solid #22263e;border-radius:10px;padding:10px}
      </style>
      <div class=wrap>
        <h1>Built‑in Demo Page</h1>
        <div class=card>
          <p>This is an embedded page served via <code>srcdoc</code>. It has a tiny interactive widget below.</p>
          <form id=f>
            <input id=name placeholder="Your name" />
            <button type=submit>Say hi</button>
          </form>
          <p id=out></p>
        </div>
        <p class=small style="color:#a7b0c0">Tip: switch back to <strong>Live URL</strong> to load any site that permits embedding.</p>
      </div>
      <script> const f=document.getElementById('f'); const out=document.getElementById('out'); f.addEventListener('submit',e=>{e.preventDefault(); out.textContent='Hello, '+(document.getElementById('name').value||'friend')+'!';}); <\/script>
    </html>`;

    function normalize(u){
      try {
        // add https:// if the scheme is missing
        if(!/^https?:\/\//i.test(u)) u = 'https://' + u;
        const url = new URL(u);
        return url.href;
      } catch(e){
        return null;
      }
    }

    function setTab(active){
      const isLive = active === 'live';
      tabLive.classList.toggle('active', isLive);
      tabBuiltIn.classList.toggle('active', !isLive);
      tabLive.setAttribute('aria-selected', String(isLive));
      tabBuiltIn.setAttribute('aria-selected', String(!isLive));
      if(isLive){
        frame.removeAttribute('srcdoc');
        frame.src = normalize(urlInput.value) || 'about:blank';
        status.textContent = 'Mode: Live URL';
      } else {
        frame.removeAttribute('src');
        frame.setAttribute('srcdoc', builtInPage);
        status.textContent = 'Mode: Built‑in demo';
        overlay.classList.remove('show');
      }
    }

    // initial state
    setTab('live');

    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      const href = normalize(urlInput.value);
      if(!href){ status.textContent = 'Invalid URL'; return; }
      overlay.classList.remove('show');
      status.textContent = 'Loading…';
      frame.removeAttribute('srcdoc');
      frame.src = href;
    });

    clearBtn.addEventListener('click',()=>{
      urlInput.value = 'https://example.com';
      setTab('live');
    });

    document.querySelectorAll('[data-quick]').forEach(btn=>{
      btn.addEventListener('click',()=>{
        urlInput.value = btn.getAttribute('data-quick');
        setTab('live');
      });
    });

    // A best‑effort hint if a site blocks embedding
    let loadTimer;
    frame.addEventListener('load', ()=>{
      clearTimeout(loadTimer);
      status.textContent = 'Loaded';
      // Try to detect blocked embeds (heuristic only)
      loadTimer = setTimeout(()=>{
        try {
          const loc = frame.contentWindow.location.href;
          // If about:blank after load attempt, likely blocked
          if(!loc || loc === 'about:blank') overlay.classList.add('show');
        } catch(err){
          // Cross‑origin access throws; still show nothing if blocked—
          // rely on user seeing a blank frame.
        }
      }, 300);
    });
  </script>
</body>
</html>
